#==========================================
# @ConfigName        全球精品机场融合配置 (优化版)
# @Author            基于墨鱼配置 + 全球机场订阅优化
# @UpdateTime        2025年7月融合版
# @Function          支持229个全球节点、智能分流、游戏加速、家宽优选
# @ConfigVersion     3.1.0
# @Features          🌍全球6大洲节点 | 🎮游戏专线 | 🏠家宽优选 | 🚀星链网络 | 📱5G加速
#==========================================

# 基础配置
port: 7890
socks-port: 7891
redir-port: 7892
mixed-port: 7893
allow-lan: true
bind-address: "*"
mode: rule
log-level: info
ipv6: false
external-controller: 127.0.0.1:9090

# 实验性功能
experimental:
  ignore-resolve-fail: true
  sniff-tls-sni: true

# 全局配置
global-client-fingerprint: chrome

# DNS 配置优化（增强容错性与隐私性）
dns:
  enable: true
  ipv6: false
  listen: 0.0.0.0:53
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  respect-rules: true
  fake-ip-filter:
    - "*.lan"
    - "*.localdomain"
    - "*.example"
    - "*.invalid"
    - "*.localhost"
    - "*.test"
    - "*.local"
    - "*.home.arpa"
    - time.*.com
    - time.*.gov
    - time.*.edu.cn
    - time.*.apple.com
    - time1.*.com
    - time2.*.com
    - time3.*.com
    - time4.*.com
    - time5.*.com
    - time6.*.com
    - time7.*.com
    - ntp.*.com
    - ntp1.*.com
    - ntp2.*.com
    - ntp3.*.com
    - ntp4.*.com
    - ntp5.*.com
    - ntp6.*.com
    - ntp7.*.com
    - "*.time.edu.cn"
    - "*.ntp.org.cn"
    - +.pool.ntp.org
    - localhost.ptlogin2.qq.com
    - +.srv.nintendo.net
    - +.stun.playstation.net
    - +.msftconnecttest.com
    - +.msftncsi.com
    - +.xboxlive.com
    - msftconnecttest.com
    - xbox.*.microsoft.com
    - "*.battlenet.com.cn"
    - "*.battlenet.com"
    - "*.blzstatic.cn"
    - "*.battle.net"
  nameserver:
    - https://223.5.5.5/dns-query
    - https://119.29.29.29/dns-query
  fallback:
    - https://1.1.1.1/dns-query
    - https://8.8.8.8/dns-query
    - tls://1.1.1.1:853
    - 223.5.5.5
    - 119.29.29.29
  fallback-filter:
    geoip: true
    geoip-code: CN
    ipcidr:
      - 240.0.0.0/4
      - 0.0.0.0/32
      - 127.0.0.1/32
    domain:
      - +.google.com
      - +.facebook.com
      - +.youtube.com
      - +.twitter.com
      - +.github.com

# 建立锚点（增强容错性）
pr:   &a3 {type: select,   proxies: [♻️ 自动选择, 🚀 手动切换, 🇭🇰 香港节点, 🇯🇵 日本节点, 🇺🇲 美国节点, 🇨🇳 台湾节点, 🇸🇬 狮城节点, 🇰🇷 韩国节点, 🇬🇧 英国节点, 🇫🇷 法国节点, 🇩🇪 德国节点, 🇨🇦 加拿大节点, 🇦🇺 澳洲节点, 🌐 故障转移, DIRECT] }
p:    &a1 {type: http,     interval: 86400,  health-check: {enable: true, url: http://www.gstatic.com/generate_204, interval: 1800, timeout: 5000} }
auto: &a4 {type: url-test, lazy: true,  url: http://www.gstatic.com/generate_204, interval: 600, tolerance: 50, timeout: 5000, use: [Sub] }
use:  &a2 {type: select,   use: [Sub] }
fallback: &a8 {type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, timeout: 5000, use: [Sub] }
loadbalance: &a9 {type: load-balance, strategy: round-robin, url: http://www.gstatic.com/generate_204, interval: 600, timeout: 5000, use: [Sub] }
c:    &a6 {type: http,     behavior: classical, interval: 86400}
d:    &a5 {type: http,     behavior: domain,    interval: 86400}
i:    &a7 {type: http,     behavior: ipcidr,    interval: 86400}

# 代理提供者（增强容错机制）
proxy-providers:
  Sub:
    <<: *a1
    url: https://你的机场订阅链接.yaml  # 请替换为你的实际订阅链接
    path: ./proxy_providers/sub.yaml
    health-check:
      enable: true
      interval: 600
      lazy: true
      url: http://www.gstatic.com/generate_204
      timeout: 5000
    override:
      additional-prefix: "[机场]"
      additional-suffix: ""
    exclude-filter: "(?i)剩余|到期|过期|官网|产品|平台|网站|备用|频道|群|测试|实验"
    include-all: true

# 代理组配置
proxy-groups:
  # 手动选择
  - {name: 🚀 手动切换, <<: *a2}
  
  # 分流策略组（增加备用选项）
  - {name: 🌏 全球加速, type: select, proxies: [♻️ 自动选择, 🚀 手动切换, 🇭🇰 香港节点, 🇯🇵 日本节点, 🇺🇲 美国节点, 🇨🇳 台湾节点, 🇸🇬 狮城节点, 🇰🇷 韩国节点, 🇬🇧 英国节点, 🇫🇷 法国节点, 🇩🇪 德国节点, 🇨🇦 加拿大节点, 🇦🇺 澳洲节点, 🌐 故障转移, 🔄 备用线路, DIRECT]}
  - {name: 🍎 苹果服务, type: select, proxies: [DIRECT, 🇺🇲 美国节点, 🇭🇰 香港节点, 🇯🇵 日本节点, 🇸🇬 狮城节点, 🔄 备用线路]}
  - {name: 📺 B站-港澳台, type: select, proxies: [🇭🇰 香港节点, 🇨🇳 台湾节点, 🇲🇴 澳门节点, 🚀 手动切换, ♻️ 自动选择]}
  - {name: 📺 B站-东南亚, type: select, proxies: [🇸🇬 狮城节点, 🇹🇭 泰国节点, 🚀 手动切换, ♻️ 自动选择]}
  - {name: 📺 B站-国内, type: select, proxies: [DIRECT, 🚀 手动切换]}
  - {name: 🤖 人工智能, type: select, proxies: [🇺🇲 美国节点, 🇯🇵 日本节点, 🇸🇬 狮城节点, 🇬🇧 英国节点, 🇫🇷 法国节点, 🔄 备用线路]}
  - {name: 🎬 国际媒体, type: select, proxies: [🇺🇲 美国节点, 🇬🇧 英国节点, 🇯🇵 日本节点, 🇸🇬 狮城节点, 🇨🇦 加拿大节点, 🔄 备用线路]}
  - {name: 🎮 游戏平台, type: select, proxies: [DIRECT, 🎯 游戏专线, 🇭🇰 香港节点, 🇯🇵 日本节点, 🇸🇬 狮城节点, 🇺🇲 美国节点, 🔄 备用线路]}
  - {name: 👨‍💻 开发加速, type: select, proxies: [🇺🇲 美国节点, 🇸🇬 狮城节点, 🇯🇵 日本节点, 🇭🇰 香港节点, 🇬🇧 英国节点, DIRECT]}
  - {name: 🌐 国际社交, type: select, proxies: [🇸🇬 狮城节点, 🇺🇲 美国节点, 🇭🇰 香港节点, 🇳🇱 荷兰节点, 🔄 备用线路]}
  # 国内服务策略组（优化体验）
  - {name: 🇨🇳 国内服务, type: select, proxies: [DIRECT, 🇭🇰 香港节点, 🇨🇳 台湾节点]}
  - {name: 💰 数字支付, type: select, proxies: [DIRECT]}
  - {name: 💬 微信服务, type: select, proxies: [DIRECT]}
  - {name: Ⓜ️ 微软服务, type: select, proxies: [DIRECT, 🇺🇲 美国节点, 🇭🇰 香港节点, 🇸🇬 狮城节点]}
  - {name: 🍃 应用净化, type: select, proxies: [REJECT, DIRECT]}
  - {name: 🆎 广告拦截, type: select, proxies: [REJECT, DIRECT]}
  - {name: 🛡️ 隐私防护, type: select, proxies: [REJECT, DIRECT]}
  - {name: 🚫 恶意网站, type: select, proxies: [REJECT, DIRECT]}
  - {name: 🔒 追踪保护, type: select, proxies: [REJECT, DIRECT]}
  - {name: 🛑 钓鱼防护, type: select, proxies: [REJECT, DIRECT]}
  - {name: 🚨 挖矿拦截, type: select, proxies: [REJECT, DIRECT]}
  - {name: 🐟 兜底分流, <<: *a3}
  
  # 特殊功能组（增强容错性）
  - {name: 🎯 游戏专线, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)游戏|game|gaming", proxies: [DIRECT]}
  - {name: 🏠 家宽优选, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 30, timeout: 5000, use: [Sub], filter: "(?i)家宽|住宅|residential", proxies: [DIRECT]}
  - {name: 🚀 星链网络, type: fallback, url: http://www.gstatic.com/generate_204, interval: 600, tolerance: 100, timeout: 8000, use: [Sub], filter: "(?i)星链|starlink", proxies: [🇺🇲 美国节点]}
  - {name: 📱 5G网络, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)5g|五代", proxies: [♻️ 自动选择]}
  
  # 故障转移组
  - {name: 🌐 故障转移, <<: *a8, filter: ".*"}
  - {name: ⚖️ 负载均衡, <<: *a9, filter: ".*"}
  
  # 备用节点组
  - {name: 🔄 备用线路, type: select, proxies: [♻️ 自动选择, 🌐 故障转移, ⚖️ 负载均衡, DIRECT]}
  
  # 云服务和托管平台
  - {name: ☁️ 云服务, type: select, proxies: [👨‍💻 开发加速, 🇺🇲 美国节点, 🇸🇬 狮城节点, 🇯🇵 日本节点, 🇭🇰 香港节点, DIRECT]}
  
  # 自动选择组
  - {name: ♻️ 自动选择, <<: *a4}
  
  # 地区节点组（覆盖全球6大洲，增强容错性）
  
  # 亚洲地区
  - {name: 🇭🇰 香港节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇭🇰|港|hk|hongkong|hong kong"}
  - {name: 🇲🇴 澳门节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇲🇴|澳门|macao|macau|mo"}
  - {name: 🇨🇳 台湾节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇹🇼|台|tw|taiwan"}
  - {name: 🇯🇵 日本节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇯🇵|日|jp|japan"}
  - {name: 🇰🇷 韩国节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇰🇷|韩|kr|korea"}
  - {name: 🇸🇬 狮城节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇸🇬|新加坡|狮城|sg|singapore"}
  - {name: 🇲🇾 马来节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇲🇾|马来|my|malaysia"}
  - {name: 🇹🇭 泰国节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇹🇭|泰|th|thailand"}
  - {name: 🇻🇳 越南节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇻🇳|越南|vn|vietnam"}
  - {name: 🇵🇭 菲律宾节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇵🇭|菲律宾|ph|philippines"}
  - {name: 🇮🇩 印尼节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇮🇩|印尼|id|indonesia"}
  - {name: 🇮🇳 印度节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇮🇳|印度|in|india"}
  
  # 欧洲地区
  - {name: 🇬🇧 英国节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇬🇧|英|uk|britain|united kingdom"}
  - {name: 🇫🇷 法国节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇫🇷|法|fr|france"}
  - {name: 🇩🇪 德国节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇩🇪|德|de|germany"}
  - {name: 🇳🇱 荷兰节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇳🇱|荷兰|nl|netherlands"}
  - {name: 🇮🇹 意大利节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇮🇹|意大利|it|italy"}
  - {name: 🇪🇸 西班牙节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇪🇸|西班牙|es|spain"}
  - {name: 🇨🇭 瑞士节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇨🇭|瑞士|ch|switzerland"}
  - {name: 🇷🇺 俄罗斯节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇷🇺|俄|ru|russia"}
  
  # 北美地区
  - {name: 🇺🇲 美国节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇺🇸|美国|us|unitedstates|united states"}
  - {name: 🇨🇦 加拿大节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇨🇦|加拿大|ca|canada"}
  - {name: 🇲🇽 墨西哥节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇲🇽|墨西哥|mx|mexico"}
  
  # 南美地区
  - {name: 🇧🇷 巴西节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇧🇷|巴西|br|brazil"}
  - {name: 🇦🇷 阿根廷节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇦🇷|阿根廷|ar|argentina"}
  - {name: 🇨🇱 智利节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇨🇱|智利|cl|chile"}
  
  # 大洋洲地区
  - {name: 🇦🇺 澳洲节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇦🇺|澳|au|australia"}
  - {name: 🇳🇿 新西兰节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇳🇿|新西兰|nz|new zealand"}
  
  # 欧洲联合节点组（用于游戏等服务）
  - {name: 🇪🇺 欧洲节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇬🇧|🇫🇷|🇩🇪|🇳🇱|🇮🇹|🇪🇸|🇨🇭|🇷🇺|英|法|德|荷兰|意大利|西班牙|瑞士|俄|uk|fr|de|nl|it|es|ch|ru|britain|france|germany|netherlands|italy|spain|switzerland|russia"}
  
  # 中东地区
  - {name: 🇦🇪 阿联酋节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇦🇪|阿联酋|ae|emirates"}
  - {name: 🇸🇦 沙特节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇸🇦|沙特|sa|saudi"}
  - {name: 🇹🇷 土耳其节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇹🇷|土耳其|tr|turkey"}

  # 非洲地区
  - {name: 🇿🇦 南非节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇿🇦|南非|za|south africa"}
  - {name: 🇪🇬 埃及节点, type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50, timeout: 5000, use: [Sub], filter: "(?i)🇪🇬|埃及|eg|egypt"}
  

# 规则提供者
rule-providers:
  # 远程规则集URL锚点
  loyal_rules: &loyal_rules "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/"
  blackmatrix_rules: &blackmatrix_rules "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/"

  # 广告拦截和隐私保护（多重防护）
  AdBlock:
    <<: *a5
    url: "*loyal_rules,reject.txt"
    path: ./ruleset/AdBlock.yaml
    
  AdBlockDomain:
    <<: *a6
    url: "*blackmatrix_rules,Advertising/Advertising.yaml"
    path: ./ruleset/AdBlockDomain.yaml
    
  AdGuardSDNSFilter:
    <<: *a5
    url: "https://raw.githubusercontent.com/AdguardTeam/AdguardFilters/master/BaseFilter/sections/adservers.txt"
    path: ./ruleset/AdGuardSDNSFilter.yaml
    
  EasyList:
    <<: *a5
    url: "https://easylist.to/easylist/easylist.txt"
    path: ./ruleset/EasyList.yaml
    
  EasyPrivacy:
    <<: *a5
    url: "https://easylist.to/easylist/easyprivacy.txt"
    path: ./ruleset/EasyPrivacy.yaml
    
  Privacy:
    <<: *a5
    url: "*loyal_rules,private.txt"
    path: ./ruleset/Privacy.yaml
    
  Tracking:
    <<: *a6
    url: "*blackmatrix_rules,Privacy/Privacy.yaml"
    path: ./ruleset/Tracking.yaml
    
  Hijacking:
    <<: *a6
    url: "*blackmatrix_rules,Hijacking/Hijacking.yaml"
    path: ./ruleset/Hijacking.yaml
    
  Malware:
    <<: *a5
    url: "https://raw.githubusercontent.com/hectorm/hmirror/master/data/malware-filter/list.txt"
    path: ./ruleset/Malware.yaml
    
  Phishing:
    <<: *a5
    url: "https://raw.githubusercontent.com/hectorm/hmirror/master/data/phishing-filter/list.txt"
    path: ./ruleset/Phishing.yaml

  # AI 服务规则集
  OpenAI:
    <<: *a6
    url: "*blackmatrix_rules,OpenAI/OpenAI.yaml"
    path: ./ruleset/OpenAI.yaml
    
  Claude:
    <<: *a6  
    url: "*blackmatrix_rules,Claude/Claude.yaml"
    path: ./ruleset/Claude.yaml
    
  Copilot:
    <<: *a6
    url: "*blackmatrix_rules,Copilot/Copilot.yaml" 
    path: ./ruleset/Copilot.yaml
    
  Gemini:
    <<: *a6
    url: "*blackmatrix_rules,Gemini/Gemini.yaml"
    path: ./ruleset/Gemini.yaml
    
  # 自定义AI服务规则
  AIServices:
    <<: *a6
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/AI/AI.yaml"
    path: ./ruleset/AIServices.yaml

  # 流媒体服务规则集
  Animation:
    <<: *a6
    url: "*blackmatrix_rules,Animation/Animation.yaml"
    path: ./ruleset/Animation.yaml
  BiliBili:
    <<: *a6
    url: "*blackmatrix_rules,BiliBili/BiliBili.yaml"
    path: ./ruleset/BiliBili.yaml
    
  GlobalMedia:
    <<: *a6
    url: "*blackmatrix_rules,GlobalMedia/GlobalMedia_Classical.yaml"
    path: ./ruleset/GlobalMedia.yaml
    
  Netflix:
    <<: *a6
    url: "*blackmatrix_rules,Netflix/Netflix.yaml"
    path: ./ruleset/Netflix.yaml
    
  Disney:
    <<: *a6
    url: "*blackmatrix_rules,Disney/Disney.yaml"
    path: ./ruleset/Disney.yaml
    
  YouTube:
    <<: *a6
    url: "*blackmatrix_rules,YouTube/YouTube.yaml"
    path: ./ruleset/YouTube.yaml
    
  PrimeVideo:
    <<: *a6
    url: "*blackmatrix_rules,AmazonPrimeVideo/AmazonPrimeVideo.yaml"
    path: ./ruleset/PrimeVideo.yaml
    
  HBO:
    <<: *a6
    url: "*blackmatrix_rules,HBO/HBO.yaml"
    path: ./ruleset/HBO.yaml
    
  Hulu:
    <<: *a6
    url: "*blackmatrix_rules,Hulu/Hulu.yaml"
    path: ./ruleset/Hulu.yaml
    
  Paramount:
    <<: *a6
    url: "*blackmatrix_rules,ParamountPlus/ParamountPlus.yaml"
    path: ./ruleset/Paramount.yaml
    
  AppleTV:
    <<: *a6
    url: "*blackmatrix_rules,AppleTV/AppleTV.yaml"
    path: ./ruleset/AppleTV.yaml
    
  Spotify:
    <<: *a6
    url: "*blackmatrix_rules,Spotify/Spotify.yaml"
    path: ./ruleset/Spotify.yaml
    
  TikTok:
    <<: *a6
    url: "*blackmatrix_rules,TikTok/TikTok.yaml"
    path: ./ruleset/TikTok.yaml
    
  Twitch:
    <<: *a6
    url: "*blackmatrix_rules,Twitch/Twitch.yaml"
    path: ./ruleset/Twitch.yaml

  # 社交平台
  SocialMedia:
    <<: *a6
    url: "*blackmatrix_rules,SocialMedia/SocialMedia.yaml"
    path: ./ruleset/SocialMedia.yaml
  Telegram:
    <<: *a6
    url: "*blackmatrix_rules,Telegram/Telegram.yaml"
    path: ./ruleset/Telegram.yaml
    
  Twitter:
    <<: *a6
    url: "*blackmatrix_rules,Twitter/Twitter.yaml"
    path: ./ruleset/Twitter.yaml

  # 科技服务
  Apple:
    <<: *a6
    url: "*blackmatrix_rules,Apple/Apple_Classical.yaml"
    path: ./ruleset/Apple.yaml
    
  Google:
    <<: *a6
    url: "*blackmatrix_rules,Google/Google.yaml" 
    path: ./ruleset/Google.yaml
    
  Microsoft:
    <<: *a6
    url: "*blackmatrix_rules,Microsoft/Microsoft.yaml"
    path: ./ruleset/Microsoft.yaml
    
  # 开发者平台规则集
  GitHub:
    <<: *a6
    url: "*blackmatrix_rules,GitHub/GitHub.yaml"
    path: ./ruleset/GitHub.yaml
    
  GitLab:
    <<: *a6
    url: "*blackmatrix_rules,GitLab/GitLab.yaml"
    path: ./ruleset/GitLab.yaml
    
  Docker:
    <<: *a6
    url: "*blackmatrix_rules,Docker/Docker.yaml"
    path: ./ruleset/Docker.yaml
    
  StackOverflow:
    <<: *a6
    url: "*blackmatrix_rules,StackExchange/StackExchange.yaml"
    path: ./ruleset/StackOverflow.yaml
    
  # 开发工具CDN
  DevCDN:
    <<: *a6
    url: "*blackmatrix_rules,Developer/Developer.yaml"
    path: ./ruleset/DevCDN.yaml

  # 腾讯服务
  Tencent:
    <<: *a6
    url: "*blackmatrix_rules,Tencent/Tencent.yaml"
    path: ./ruleset/Tencent.yaml

  # 游戏平台规则集
  Game:
    <<: *a6
    url: "*blackmatrix_rules,Game/Game.yaml"
    path: ./ruleset/Game.yaml
    
  Steam:
    <<: *a6
    url: "*blackmatrix_rules,Steam/Steam.yaml"
    path: ./ruleset/Steam.yaml
    
  Epic:
    <<: *a6
    url: "*blackmatrix_rules,Epic/Epic.yaml"
    path: ./ruleset/Epic.yaml
    
  Origin:
    <<: *a6
    url: "*blackmatrix_rules,EA/EA.yaml"
    path: ./ruleset/Origin.yaml
    
  Ubisoft:
    <<: *a6
    url: "*blackmatrix_rules,UbisoftConnect/UbisoftConnect.yaml"
    path: ./ruleset/Ubisoft.yaml
    
  PlayStation:
    <<: *a6
    url: "*blackmatrix_rules,PlayStation/PlayStation.yaml"
    path: ./ruleset/PlayStation.yaml
    
  Xbox:
    <<: *a6
    url: "*blackmatrix_rules,Xbox/Xbox.yaml"
    path: ./ruleset/Xbox.yaml
    
  Nintendo:
    <<: *a6
    url: "*blackmatrix_rules,Nintendo/Nintendo.yaml"
    path: ./ruleset/Nintendo.yaml
    
  Battle.net:
    <<: *a6
    url: "*blackmatrix_rules,Blizzard/Blizzard.yaml"
    path: ./ruleset/Battle.net.yaml
    
  Riot:
    <<: *a6
    url: "*blackmatrix_rules,RiotGames/RiotGames.yaml"
    path: ./ruleset/Riot.yaml

  # 国内直连优化规则集
  ChinaDirect:
    <<: *a6
    url: "*loyal_rules,direct.txt"
    path: ./ruleset/ChinaDirect.yaml
    
  ChinaCompany:
    <<: *a6
    url: "*blackmatrix_rules,China/China.yaml"
    path: ./ruleset/ChinaCompany.yaml
    
  ChinaMedia:
    <<: *a6
    url: "*blackmatrix_rules,ChinaMedia/ChinaMedia.yaml"
    path: ./ruleset/ChinaMedia.yaml
    
  ChinaPayment:
    <<: *a6
    url: "*blackmatrix_rules,Alipay/Alipay.yaml"
    path: ./ruleset/ChinaPayment.yaml
    
  WeChat:
    <<: *a6
    url: "*blackmatrix_rules,WeChat/WeChat.yaml"
    path: ./ruleset/WeChat.yaml
    
  # 基础规则
  ProxyLite:
    <<: *a6
    url: "*loyal_rules,proxy.txt"
    path: ./ruleset/ProxyLite.yaml
    
  ChinaASN:
    <<: *a7
    url: "*loyal_rules,cncidr.txt"
    path: ./ruleset/ChinaASN.yaml
    
  Lan:
    <<: *a6
    url: "*loyal_rules,lancidr.txt"
    path: ./ruleset/Lan.yaml

# 分流规则（按优先级排序）
rules:
  # 本地网络
  - RULE-SET,Lan,DIRECT
  
  # 安全防护（多重防护体系）
  - RULE-SET,Malware,🚫 恶意网站
  - RULE-SET,Phishing,🛑 钓鱼防护
  - RULE-SET,AdBlock,🆎 广告拦截
  - RULE-SET,AdBlockDomain,🆎 广告拦截
  - RULE-SET,AdGuardSDNSFilter,🆎 广告拦截
  - RULE-SET,EasyList,🆎 广告拦截
  - RULE-SET,EasyPrivacy,🔒 追踪保护
  - RULE-SET,Privacy,🛡️ 隐私防护
  - RULE-SET,Tracking,🔒 追踪保护
  - RULE-SET,Hijacking,🍃 应用净化
  
  # AI 服务优化
  - RULE-SET,OpenAI,🤖 人工智能
  - RULE-SET,Claude,🤖 人工智能
  - RULE-SET,Copilot,🤖 人工智能
  - RULE-SET,Gemini,🤖 人工智能
  - RULE-SET,AIServices,🤖 人工智能
  
  # 流媒体服务优化
  - RULE-SET,Animation,🎬 国际媒体
  - RULE-SET,Netflix,🎬 国际媒体
  - RULE-SET,Disney,🎬 国际媒体
  - RULE-SET,PrimeVideo,🎬 国际媒体
  - RULE-SET,HBO,🎬 国际媒体
  - RULE-SET,Hulu,🎬 国际媒体
  - RULE-SET,Paramount,🎬 国际媒体
  - RULE-SET,AppleTV,🎬 国际媒体
  - RULE-SET,YouTube,🎬 国际媒体
  - RULE-SET,Spotify,🎬 国际媒体
  - RULE-SET,TikTok,🎬 国际媒体
  - RULE-SET,Twitch,🎬 国际媒体
  - DOMAIN-SUFFIX,api.bilibili.com.tw,📺 B站-港澳台
  - DOMAIN-SUFFIX,app.biliintl.com,📺 B站-东南亚
  - RULE-SET,BiliBili,📺 B站-国内
  - RULE-SET,GlobalMedia,🎬 国际媒体
  
  # 社交通讯
  - RULE-SET,SocialMedia,🌐 国际社交
  - RULE-SET,Telegram,🌐 国际社交
  - RULE-SET,Twitter,🌐 国际社交
  
  # 科技服务
  - RULE-SET,Apple,🍎 苹果服务
  - RULE-SET,Google,🌌 谷歌服务
  - RULE-SET,Microsoft,Ⓜ️ 微软服务
  
  # 开发者平台优化
  - RULE-SET,GitHub,👨‍💻 开发加速
  - RULE-SET,GitLab,👨‍💻 开发加速
  - RULE-SET,Docker,👨‍💻 开发加速
  - RULE-SET,StackOverflow,👨‍💻 开发加速
  - RULE-SET,DevCDN,👨‍💻 开发加速
  
  # 腾讯服务
  - RULE-SET,Tencent,🇨🇳 国内服务
  - RULE-SET,WeChat,💬 微信服务
  
  # 国内直连优化
  - RULE-SET,ChinaDirect,🇨🇳 国内服务
  - RULE-SET,ChinaCompany,🇨🇳 国内服务
  - RULE-SET,ChinaMedia,🇨🇳 国内服务
  - RULE-SET,ChinaPayment,💰 数字支付
  
  # 游戏平台优化
  - RULE-SET,Steam,🎮 游戏平台
  - RULE-SET,Epic,🎮 游戏平台
  - RULE-SET,Origin,🎮 游戏平台
  - RULE-SET,Ubisoft,🎮 游戏平台
  - RULE-SET,PlayStation,🎮 游戏平台
  - RULE-SET,Xbox,🎮 游戏平台
  - RULE-SET,Nintendo,🎮 游戏平台
  - RULE-SET,Battle.net,🎮 游戏平台
  - RULE-SET,Riot,🎮 游戏平台
  - RULE-SET,Game,🎮 游戏平台
  
  # 全球代理
  - RULE-SET,ProxyLite,🌏 全球加速
  
  # 国内直连（确保最优路径）
  - GEOIP,CN,🇨🇳 国内服务
  
  # 兜底规则
  - MATCH,🐟 兜底分流

# TUN 模式配置
tun:
  enable: false
  stack: system
  auto-route: true
  auto-detect-interface: true
  dns-hijack:
    - 198.18.0.2:53

#==========================================
# 📝 配置文件说明
#==========================================
#
# 此版本基于原版进行了以下优化：
# 1. DNS优化: 优先使用加密DNS (DoH/DoT)，将常规DNS作为备用，增强隐私和安全性。
# 2. 规则精简: 移除了大量与规则集(RULE-SET)重复的域名(DOMAIN-SUFFIX)规则。
#    这使得配置文件更简洁、高效，并依赖于社区维护的最新规则列表。
#
#==========================================
# 🎯 配置说明与使用指南
#==========================================
# 
# 📝 基础设置：
# 1. 替换订阅：将 "https://你的机场订阅链接.yaml" 替换为你的实际订阅链接
# 2. 开启TUN：如需TUN模式，将 "enable: false" 改为 "enable: true"
# 
# 🌟 特色功能说明：
# - 🎯 游戏专线：自动筛选机场中的游戏专用节点，延迟更低
# - 🏠 家宽优选：自动选择家宽/住宅IP节点，更稳定不易封号
# - 🚀 星链网络：马斯克星链卫星网络节点，覆盖偏远地区
# - 📱 5G网络：5G移动网络节点，速度更快
# 
# 🌍 全球节点覆盖：
# 亚洲：香港、澳门、台湾、日本、韩国、新加坡、马来西亚、泰国、越南、菲律宾、印尼、印度等
# 欧洲：英国、法国、德国、荷兰、意大利、西班牙、瑞士、俄罗斯等
# 北美：美国、加拿大、墨西哥
# 南美：巴西、阿根廷、智利
# 大洋洲：澳大利亚、新西兰
# 非洲：南非、埃及
# 中东：阿联酋、沙特、土耳其
# 
# 🎮 游戏优化：
# - 游戏平台会优先使用游戏专线节点
# - 支持Steam、Epic、PlayStation、Xbox等平台
# 
# 📺 流媒体全覆盖：
# 国际流媒体：Netflix、Disney+、HBO Max/Max、Prime Video、Hulu、Paramount+、Apple TV+
# 音视频平台：YouTube、Spotify、TikTok、Twitch、Vimeo、SoundCloud、Pandora
#==========================================
# 🛡️ 容错机制和故障处理说明
#==========================================
# 
# 🔧 DNS容错机制：
# - 多重DNS服务器：国内(223.5.5.5, 119.29.29.29) + 国外(1.1.1.1, 8.8.8.8)
# - DNS-over-HTTPS + 传统DNS双重保障
# - DNS-over-TLS加密传输保护隐私
# - respect-rules确保DNS查询遵循分流规则
# 
# 🌐 节点容错机制：
# - Fallback模式：主节点故障时自动切换到备用节点
# - 故障转移组：🌐 故障转移，所有节点统一管理
# - 负载均衡组：⚖️ 负载均衡，分散流量压力
# - 备用线路组：🔄 备用线路，多重保障
# - 健康检查：每5分钟检测，超时5秒自动切换
# 
# 🎯 订阅容错机制：
# - 自动过滤：排除无效、过期、测试节点
# - 健康检查：定期检测节点可用性
# - 订阅缓存：本地保存，订阅服务器故障时仍可使用
# - 超时保护：连接超时5秒自动重试
# 
# 📋 规则容错机制：
# - 多重规则源：Loyalsoldier + blackmatrix7 + AdGuard等
# - 手动补充：重要域名手动添加，避免规则遗漏
# - 规则缓存：本地保存86400秒，减少依赖
# - 兜底规则：MATCH规则确保所有流量都有去向
# 
# 🚨 故障场景处理：
# 
# 1️⃣ 订阅服务器故障：
#    - 使用本地缓存的节点配置
#    - 手动导入备用订阅链接
#    - 切换到"🔄 备用线路"组
# 
# 2️⃣ 主要节点故障：
#    - Fallback自动切换到同地区其他节点
#    - 使用"🌐 故障转移"统一管理
#    - 临时切换到"⚖️ 负载均衡"分散压力
# 
# 3️⃣ 整个地区节点故障：
#    - 策略组中的"🔄 备用线路"选项
#    - 手动切换到其他地区节点
#    - 使用DIRECT直连（适用于部分服务）
# 
# 4️⃣ DNS解析故障：
#    - 自动切换到备用DNS服务器
#    - Fallback机制使用国外DNS
#    - 手动切换enhanced-mode为redir-host
# 
# 5️⃣ 规则更新失败：
#    - 使用本地缓存的规则文件
#    - 手动域名规则确保核心服务可用
#    - 兜底规则确保所有流量正常转发
# 
# 6️⃣ 特定服务无法访问：
#    - 每个服务都有多个节点选择
#    - 备用线路选项作为最后保障
#    - 可临时调整为DIRECT直连测试
# 
# 💡 使用建议：
# - 定期检查节点健康状态
# - 重要服务保存多个备用方案
# - 遇到问题先切换"🔄 备用线路"
# - 极端情况下可临时使用DIRECT
# - 建议备份配置文件到本地
#
#==========================================
# 
# 🤖 AI服务全覆盖：
# 聊天AI：OpenAI ChatGPT、Claude、Gemini/Bard、Poe、Character.AI、Perplexity
# 图像AI：Midjourney、Stable Diffusion、Leonardo.AI、Runway、DALL-E、Civitai
# 代码AI：GitHub Copilot、Cursor、Codeium、Tabby
# 写作AI：Jasper、Copy.ai、Writesonic、Grammarly、Notion AI
# 语音AI：ElevenLabs、Murf、Speechify、Otter.ai、Fireflies
# 音乐AI：Suno、Mubert、Soundraw、Boomy
# 视频AI：Synthesia、Runway ML
# 翻译AI：DeepL
# 演示AI：Gamma、Tome
# 开发平台：Hugging Face、Replicate、RunPod、Cohere
# 
# ⚙️ 高级设置：
# - 自动健康检查：每10分钟检测节点可用性
# - 故障切换：节点故障时自动切换到备用节点
# - 负载均衡：支持多节点负载均衡
# 
# 🔧 自定义选项：
# - 可根据需要调整各地区节点的检测间隔
# - 可自定义容差值来控制节点切换的敏感度
# - 支持手动选择和自动切换两种模式
#
# 💡 使用建议：
# 1. 首次使用建议选择"自动选择"，让系统自动选择最优节点
# 2. 游戏时优先使用"游戏专线"或对应地区的游戏节点
# 3. 流媒体观看时选择对应服务的优化节点
# 4. 需要稳定IP时选择"家宽优选"
# 5. 特殊需求时可使用"星链网络"或"5G网络"
#
#==========================================
